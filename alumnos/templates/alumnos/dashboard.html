{% extends "base.html" %}

{% block content %}
<style>
  /* Fondo general con degradado sutil */
  body {
    background: linear-gradient(135deg, #0d6efd15, #6610f220);
    min-height: 100vh;
  }
  /* Hero superior */
  .hero {
    background: linear-gradient(135deg, #0d6efd, #6610f2);
    color: #fff;
    border-radius: 1rem;
    box-shadow: 0 10px 20px rgba(0,0,0,.15);
  }
  /* Tarjetas de alumno */
  .alumno-card {
    border: 0;
    border-radius: .75rem;
    box-shadow: 0 8px 20px rgba(0,0,0,.08);
    transition: transform .15s ease, box-shadow .15s ease;
    background: #fff;
  }
  .alumno-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 26px rgba(0,0,0,.12);
  }
  /* Badge estilizado */
  .badge-soft {
    background: rgba(13,110,253,.12);
    color: #0d6efd;
    border: 1px solid rgba(13,110,253,.25);
  }
  /* Botones compactos */
  .btn-icon {
    display: inline-flex;
    align-items: center;
    gap: .35rem;
  }
  /* Tabla moderna */
  .table-modern thead {
    background: #0e0e11;
    color: #fff;
  }
  .table-modern tbody tr {
    transition: background-color .1s ease;
  }
  .table-modern tbody tr:hover {
    background-color: rgba(13,110,253,.06);
  }
</style>

<div class="container py-4">

  <!-- Hero header -->
  <div class="hero p-4 p-md-5 mb-4">
    <div class="d-flex flex-wrap align-items-center justify-content-between">
      <div>
        <h1 class="h3 h-md2 mb-2">Mis Alumnos</h1>
        <p class="mb-0 opacity-75">Gestion√° tu lista, gener√° PDFs y manten√© todo prolijo y profesional.</p>
      </div>
      <div class="d-flex gap-2">
        <a href="{% url 'crear_alumno' %}" class="btn btn-success btn-icon">
          <span>‚ûï</span> <span>Crear alumno</span>
        </a>
        <form action="{% url 'logout' %}" method="post" class="d-inline">
          {% csrf_token %}
          <button type="submit" class="btn btn-outline-light btn-icon">
            <span>üîí</span> <span>Cerrar sesi√≥n</span>
          </button>
        </form>
      </div>
    </div>
  </div>

  <!-- Mensajes -->
  {% if messages %}
    <div class="mb-3">
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show shadow-sm" role="alert">
          <span class="me-1">{% if message.tags == 'success' %}‚úÖ{% elif message.tags == 'warning' %}‚ö†Ô∏è{% elif message.tags == 'danger' %}‚õî{% else %}‚ÑπÔ∏è{% endif %}</span>
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- Toolbar: b√∫squeda y vista -->
  <div class="card border-0 shadow-sm mb-4">
    <div class="card-body">
      <div class="row g-3 align-items-center">
        <div class="col-12 col-md-6">
          <form class="d-flex" role="search">
            <input class="form-control me-2" type="search" placeholder="Buscar por nombre, email o carrera" aria-label="Buscar">
            <button class="btn btn-primary" type="button">Buscar</button>
          </form>
        </div>
        <div class="col-6 col-md-3">
          <select class="form-select">
            <option selected>Ordenar por</option>
            <option value="1">Recientes</option>
            <option value="2">Nombre</option>
            <option value="3">Carrera</option>
          </select>
        </div>
        <div class="col-6 col-md-3 text-md-end">
          <div class="btn-group" role="group" aria-label="Cambiar vista">
            <button type="button" class="btn btn-outline-primary active">Tarjetas</button>
            <button type="button" class="btn btn-outline-primary">Tabla</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  {% if alumnos %}
    <!-- Grid de tarjetas -->
    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4 mb-4">
      {% for alumno in alumnos %}
        <div class="col">
          <div class="card alumno-card h-100">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start mb-2">
                <h5 class="card-title mb-0">{{ alumno.nombre }}</h5>
                <span class="badge badge-soft">ID: {{ alumno.id }}</span>
              </div>
              <p class="card-text mb-3">
                <span class="d-block"><strong>Email:</strong> {{ alumno.email }}</span>
                <span class="d-block"><strong>Carrera:</strong> {{ alumno.carrera }}</span>
                <span class="d-block"><strong>Calificaci√≥n:</strong> {{ alumno.calificacion }}</span>
                <span class="d-block text-muted"><strong>Creado:</strong> {{ alumno.creado|date:"d/m/Y H:i" }}</span>
              </p>
              <div class="d-flex flex-wrap gap-2">
                <a href="{% url 'editar_alumno' alumno.id %}" class="btn btn-warning btn-sm btn-icon">
                  ‚úèÔ∏è <span>Editar</span>
                </a>
                <form action="{% url 'borrar_alumno' alumno.id %}" method="post" class="d-inline">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-danger btn-sm btn-icon">
                    üóëÔ∏è <span>Eliminar</span>
                  </button>
                </form>
                <a href="{% url 'descargar_pdf_alumno' alumno.id %}" class="btn btn-info btn-sm btn-icon text-white">
                  üìÑ <span>PDF</span>
                </a>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- Tabla moderna -->
    <div class="card border-0 shadow-sm">
      <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
        <span class="fw-semibold">Listado detallado</span>
        <span class="badge bg-secondary">Total: {{ alumnos|length }}</span>
      </div>
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-modern mb-0 align-middle">
            <thead>
              <tr>
                <th>Nombre</th>
                <th>Email</th>
                <th>Carrera</th>
                <th>Calificaci√≥n</th>
                <th>Creado</th>
                <th class="text-end">Acciones</th>
              </tr>
            </thead>
            <tbody>
              {% for alumno in alumnos %}
                <tr>
                  <td class="fw-semibold">{{ alumno.nombre }}</td>
                  <td>{{ alumno.email }}</td>
                  <td><span class="badge bg-primary-subtle text-primary border">{{ alumno.carrera }}</span></td>
                  <td>{{ alumno.calificacion }}</td>
                  <td class="text-muted">{{ alumno.creado|date:"d/m/Y H:i" }}</td>
                  <td class="text-end">
                    <div class="btn-group">
                      <a href="{% url 'editar_alumno' alumno.id %}" class="btn btn-outline-warning btn-sm">Editar</a>
                      <a href="{% url 'descargar_pdf_alumno' alumno.id %}" class="btn btn-outline-info btn-sm">PDF</a>
                      <form action="{% url 'borrar_alumno' alumno.id %}" method="post" class="d-inline">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-outline-danger btn-sm">Eliminar</button>
                      </form>
                    </div>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>

  {% else %}
    <!-- Estado vac√≠o elegante -->
    <div class="card border-0 shadow-sm">
      <div class="card-body text-center py-5">
        <div class="display-6 mb-3">üòå</div>
        <h5 class="mb-2">Todav√≠a no cargaste alumnos</h5>
        <p class="text-muted mb-4">Cre√° tu primer alumno para empezar a gestionar tu lista.</p>
        <a href="{% url 'crear_alumno' %}" class="btn btn-success btn-icon">
          ‚ûï <span>Crear alumno</span>
        </a>
      </div>
    </div>
  {% endif %}
</div>
{% endblock %}